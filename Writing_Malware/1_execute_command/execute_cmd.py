import subprocess

# Commands should vary depending on target OS.
command = 'Add-Type -AssemblyName "System.Windows.Forms"; [System.Windows.Forms.MessageBox]::Show("You have been hacked")'

# Run the powershell command vis subprocess.Popen()
process = subprocess.Popen(['powershell', '-Command', command], stdout=subprocess.PIPE, stderr=subprocess.PIPE)

# Capture output and errors
stdout, stderr = process.communicate()

if stdout:
    print(stdout.decode())
if stderr:
    print(stderr.decode())
